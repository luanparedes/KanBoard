<!DOCTYPE html>
<html>
<head>
    <title>Spotify API Example</title>
    <script>
        // Esta função será chamada quando a página for carregada
        window.onload = function () {
            // Obter o token de acesso da URL
            const params = new URLSearchParams(window.location.hash.replace('#', '?'));
            const accessToken = params.get('access_token');
            document.getElementById("saida").innerHTML = accessToken;

            if (accessToken) {
                // Chamada à API do Spotify para obter informações do usuário
                fetch('https://api.spotify.com/v1/me', {
                    headers: {
                        'Authorization': 'Bearer ' + accessToken
                    }
                })
                .then(response => response.json())
                .then(data => {
                    // Manipular os dados recebidos
                    console.log(data);
                    document.getElementById('userInfo').innerText = JSON.stringify(data, null, 2);
                })
                .catch(error => console.error('Error:', error));
            } else {
                // Redirecionar o usuário para a página de autenticação do Spotify
                const clientId = '3d1fe76afb55445bb1d1b61ce16f75bf';
                const redirectUri = 'http://localhost:PORT';
                const scopes = 'user-library-read';
                const authUrl = `https://accounts.spotify.com/authorize?client_id=${clientId}&response_type=token&redirect_uri=${redirectUri}&scope=${scopes}`;
                window.location.href = authUrl;
            }
        };
    </script>
</head>
<body>
    <h1>Spotify API Example</h1>
    <div id="saida"></div>
</body>
</html>
